-- Full curriculum for Practitioner GRC (BH-GRC-2) and Specialisations: IAM, Cloud, Advanced GRC.
-- Replaces placeholder modules and lessons with substantial, exam-ready content.
-- Course IDs: BH-GRC-2 = 000008, BH-SPEC-IAM = 000009, BH-SPEC-CLOUD = 00000a, BH-SPEC-GRC = 00000b.

BEGIN;

-- Remove placeholder content (lessons first due to FK, then modules)
DELETE FROM public.lessons
WHERE module_id IN (
  SELECT id FROM public.modules
  WHERE course_id IN (
    SELECT id FROM public.courses
    WHERE code IN ('BH-GRC-2', 'BH-SPEC-IAM', 'BH-SPEC-CLOUD', 'BH-SPEC-GRC')
  )
);
DELETE FROM public.modules
WHERE course_id IN (
  SELECT id FROM public.courses
  WHERE code IN ('BH-GRC-2', 'BH-SPEC-IAM', 'BH-SPEC-CLOUD', 'BH-SPEC-GRC')
);

-- ========== BH-GRC-2: MODULES ==========
INSERT INTO public.modules (id, course_id, title, description, order_index) VALUES
  ('d0000000-0000-4000-8000-000000000001', 'a0000000-0000-4000-8000-000000000008', 'GRC Foundations', 'Governance, risk, and compliance in the context of cybersecurity.', 1),
  ('d0000000-0000-4000-8000-000000000002', 'a0000000-0000-4000-8000-000000000008', 'Risk Management', 'Identification, assessment, treatment, and monitoring of risk.', 2),
  ('d0000000-0000-4000-8000-000000000003', 'a0000000-0000-4000-8000-000000000008', 'Policy and Control Frameworks', 'Policies, standards, and common frameworks.', 3),
  ('d0000000-0000-4000-8000-000000000004', 'a0000000-0000-4000-8000-000000000008', 'Compliance and Audit', 'Compliance programmes, audits, and reporting.', 4);

-- ========== BH-GRC-2: LESSONS (Module 1) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000001', 'd0000000-0000-4000-8000-000000000001', 'What is GRC?', 'Governance, risk, and compliance defined.', E'# What is GRC?\n\n## Introduction\n\nThis lesson defines governance, risk, and compliance and how they work together in organisations. You will learn why GRC matters for security and how it supports decision-making and accountability.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define governance, risk, and compliance and how they differ.\n- Explain how GRC supports security and business objectives.\n- Describe the role of the practitioner in a GRC function.\n\n## Governance\n\n**Governance** is the set of structures, policies, and processes that direct and control the organisation. It defines who is accountable, who makes decisions, and how performance is measured. In security, governance ensures that security strategy aligns with business goals and that roles and responsibilities are clear. Boards and executive leadership set direction; security and risk teams implement and report.\n\n## Risk\n\n**Risk** is the effect of uncertainty on objectives. Risk management identifies what could go wrong, assesses likelihood and impact, and decides how to respond (accept, mitigate, transfer, or avoid). Security risk is a subset of organisational risk: threats to confidentiality, integrity, availability, and compliance. GRC practitioners help identify, assess, and report security risk so leadership can prioritise and fund controls.\n\n## Compliance\n\n**Compliance** means meeting legal, regulatory, and contractual obligations. Organisations must comply with laws (e.g. data protection), industry standards (e.g. payment card rules), and contracts (e.g. security and privacy clauses). Compliance drives many security controls; GRC practitioners map controls to requirements, collect evidence, and support audits.\n\n## How GRC Fits Together\n\nGovernance sets the framework; risk management identifies what to address; compliance ensures the organisation meets its obligations. Together they create a coherent approach to security that is accountable, risk-based, and demonstrable to regulators and partners.\n\n## Key takeaway\n\nGRC combines governance (direction and accountability), risk (uncertainty and response), and compliance (meeting obligations). Practitioners support all three to align security with business and regulatory needs.\n\n## Exam alignment\n\nISC² SSCP (Security Operations; risk, compliance).', 25, 1),
  ('e0000000-0000-4000-8000-000000000002', 'd0000000-0000-4000-8000-000000000001', 'The Role of Security in the Organisation', 'How security supports business and reports to leadership.', E'# The Role of Security in the Organisation\n\n## Introduction\n\nThis lesson explains how the security function fits within the organisation and how it communicates with leadership and other teams. You will learn reporting lines, key stakeholders, and how to position security as an enabler.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Describe typical reporting lines for security (CISO, risk, IT).\n- Identify key stakeholders: board, executives, legal, HR, IT, business units.\n- Explain how to communicate security value in business terms.\n\n## Where Security Sits\n\nThe security function may report to the chief information security officer (CISO), who often reports to the CEO, COO, or CIO. In some organisations security sits under IT; in others it is separate. Governance defines escalation paths and who approves policy and major risk decisions. Understanding the structure helps you know who to inform and who can authorise change.\n\n## Stakeholders\n\n**Board and executives** need high-level risk and compliance status and strategic decisions (e.g. risk acceptance, investment). **Legal and compliance** need evidence of control implementation and breach or audit implications. **HR** is a partner for policy enforcement, awareness, and insider risk. **IT** implements technical controls and operates systems. **Business units** own their processes and data and must comply with policy. GRC practitioners work with all of these to gather information, report status, and support decisions.\n\n## Communicating Value\n\nSecurity is more effective when framed in business terms: protection of revenue, reputation, and legal standing; enablement of contracts and partnerships; and reduction of loss. Use metrics (e.g. open findings, audit results, incidents) and tie recommendations to risk and business impact so leadership can prioritise.\n\n## Key takeaway\n\nSecurity supports the organisation through clear governance, risk-based decisions, and compliance. Building relationships with stakeholders and communicating in business terms increases influence and resourcing.\n\n## Exam alignment\n\nISC² SSCP (Security Operations; organisational context).', 22, 2),
  ('e0000000-0000-4000-8000-000000000003', 'd0000000-0000-4000-8000-000000000001', 'Ethics and Professional Conduct', 'Ethical behaviour and professional standards in GRC.', E'# Ethics and Professional Conduct\n\n## Introduction\n\nThis lesson covers ethical behaviour and professional standards for GRC and security practitioners. You will learn why ethics matter and how to handle conflicts and sensitive information.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Explain why ethics and professional conduct matter in GRC.\n- Describe how to handle conflicts of interest and confidential information.\n- Apply a simple ethical decision-making approach.\n\n## Why Ethics Matter\n\nGRC practitioners handle sensitive information: risk assessments, audit findings, incidents, and personal data. They may influence decisions about resource allocation, risk acceptance, and disciplinary action. Acting with integrity protects the organisation, builds trust, and reduces legal and reputational risk. Professional bodies and employers expect adherence to a code of ethics.\n\n## Conflicts of Interest\n\nA **conflict of interest** exists when personal interests could influence or appear to influence professional judgement. Examples: assessing a system you helped build; having a financial interest in a vendor; favouring a friend''s department in an audit. Disclose conflicts to your manager or compliance; recuse yourself from decisions where appropriate; document the approach.\n\n## Handling Confidential Information\n\nTreat risk and compliance information as confidential. Share only with those who need it for their role; use secure channels; do not discuss in public or on unsecured devices. Follow data classification and retention policies. In audits, protect the confidentiality of evidence and findings within the scope of the audit report.\n\n## Ethical Decision-Making\n\nWhen faced with an ethical dilemma: identify the issue and who is affected; refer to policy, code of conduct, and law; consider options and consequences; seek guidance (manager, legal, ethics officer) when needed; document the decision and rationale. When in doubt, escalate.\n\n## Key takeaway\n\nEthics and professional conduct are foundational. Disclose conflicts, protect confidential information, and use a structured approach when making ethical decisions.\n\n## Exam alignment\n\nISC² SSCP (Ethics; professional conduct).', 20, 3);

-- ========== BH-GRC-2: LESSONS (Module 2 — Risk Management) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000004', 'd0000000-0000-4000-8000-000000000002', 'Risk Identification', 'How to identify and catalogue risks.', E'# Risk Identification\n\n## Introduction\n\nThis lesson covers how to identify risks to the organisation: assets, threats, vulnerabilities, and scenarios. You will learn sources of risk information and how to document and categorise risks.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Identify assets, threats, and vulnerabilities relevant to security.\n- Use sources such as threat intelligence, audits, and incidents to find risks.\n- Document and categorise risks for assessment.\n\n## Assets and What We Protect\n\n**Assets** are what the organisation values and must protect: data (customer, financial, intellectual property), systems (applications, infrastructure), people, and reputation. Risk identification starts by listing critical assets and their owners. Asset inventories and data classification support this.\n\n## Threats and Vulnerabilities\n\n**Threats** are potential causes of harm: threat actors (attackers, insiders), natural events (fire, flood), and failures (system failure, human error). **Vulnerabilities** are weaknesses that threats can exploit: unpatched software, weak access controls, misconfigurations. Identify threats from threat intelligence, incident history, and industry reports; identify vulnerabilities from scans, audits, and assessments.\n\n## Risk Scenarios\n\nA **risk scenario** describes a specific way harm could occur: e.g. "An attacker exploits a missing patch to gain access to the customer database." Scenarios link threats and vulnerabilities to assets and impacts. Use scenarios to prioritise and communicate risk.\n\n## Sources and Documentation\n\nSources include: internal (incidents, audits, risk registers, change logs); external (threat intelligence, advisories, breach reports); and structured methods (interviews, workshops, checklists). Document each risk with a clear description, affected assets, and initial categorisation so the next step (assessment) can be consistent.\n\n## Key takeaway\n\nRisk identification catalogues what could go wrong by considering assets, threats, vulnerabilities, and scenarios. Use internal and external sources and document clearly for assessment.\n\n## Exam alignment\n\nISC² SSCP (Risk identification; asset management).', 28, 1),
  ('e0000000-0000-4000-8000-000000000005', 'd0000000-0000-4000-8000-000000000002', 'Risk Assessment', 'Assessing likelihood and impact.', E'# Risk Assessment\n\n## Introduction\n\nThis lesson covers how to assess the likelihood and impact of identified risks and combine them into a risk level. You will learn qualitative and basic quantitative methods and how to use risk matrices.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define likelihood and impact and assign levels (e.g. high, medium, low).\n- Use a risk matrix to derive risk level.\n- Explain the difference between qualitative and quantitative assessment.\n\n## Likelihood and Impact\n\n**Likelihood** (or probability) is how likely the risk event is to occur. It can be expressed in categories (e.g. rare, possible, likely) or, in quantitative approaches, as a probability. Factors include threat activity, vulnerability exploitability, and existing controls. **Impact** is the consequence if the risk occurs: financial loss, operational disruption, reputational damage, legal or regulatory impact. Impact can be categorised (e.g. low, medium, high, critical) or estimated in currency or downtime.\n\n## Risk Matrices\n\nA **risk matrix** combines likelihood and impact to produce a **risk level** (e.g. 1–5 or low/medium/high/critical). For example: high likelihood and high impact = critical risk; low likelihood and low impact = low risk. The matrix helps prioritise: critical and high risks are typically addressed first. Organisations define their own scales and thresholds.\n\n## Qualitative vs Quantitative\n\n**Qualitative assessment** uses categories and expert judgement (e.g. "high", "medium"). It is faster and easier to apply consistently across many risks. **Quantitative assessment** uses numbers (e.g. expected loss in currency, annual loss expectancy). It supports cost-benefit analysis but requires data and can be complex. Many organisations use qualitative for most risks and quantitative for a subset where data exists.\n\n## Consistency and Bias\n\nUse consistent criteria and definitions so assessments are comparable. Avoid common biases: overconfidence, anchoring on past events, or underweighting rare but severe events. Calibrate with historical data and peer review where possible.\n\n## Key takeaway\n\nRisk assessment estimates likelihood and impact and combines them into a risk level. Use a risk matrix and consistent criteria; choose qualitative or quantitative methods to fit the context.\n\n## Exam alignment\n\nISC² SSCP (Risk assessment; risk analysis).', 26, 2),
  ('e0000000-0000-4000-8000-000000000006', 'd0000000-0000-4000-8000-000000000002', 'Risk Treatment and Monitoring', 'Responding to risk and tracking over time.', E'# Risk Treatment and Monitoring\n\n## Introduction\n\nThis lesson covers how organisations respond to risk (treatment options) and how they monitor risk over time. You will learn the four treatment options and the role of risk registers and reviews.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- List and describe the four risk treatment options: accept, mitigate, transfer, avoid.\n- Document risk treatment plans and ownership.\n- Explain how risk is monitored and when to reassess.\n\n## Risk Treatment Options\n\n**Accept** — The organisation consciously accepts the risk (e.g. low impact, or cost of control exceeds the risk). Acceptance should be documented, approved at the right level, and reviewed periodically. **Mitigate** — Reduce likelihood or impact through controls (e.g. patch systems, add monitoring). This is the most common response for security risk. **Transfer** — Shift some of the impact to another party (e.g. insurance, contracts). Transfer does not remove the risk; it shares the financial or operational impact. **Avoid** — Stop the activity that gives rise to the risk (e.g. discontinue a high-risk system). Use when the risk is unacceptable and cannot be sufficiently mitigated or transferred.\n\n## Treatment Plans\n\nFor each risk that is mitigated, define: actions (what will be done), owner (who is responsible), deadline, and how effectiveness will be verified. Track progress in a risk register or project plan. Escalate when owners miss deadlines or when risk level increases.\n\n## Monitoring and Review\n\nRisk is dynamic: new threats, changes in the environment, and control effectiveness change risk over time. **Monitoring** includes: tracking treatment progress; reviewing incidents and near-misses; updating when assets or threats change. **Review** cycles (e.g. quarterly risk committee, annual risk assessment) ensure the register is current and priorities are still correct. Key risk indicators (KRIs) can signal when risk exposure is increasing.\n\n## Key takeaway\n\nRisk treatment chooses among accept, mitigate, transfer, and avoid. Document plans and ownership; monitor and review regularly so risk decisions stay current.\n\n## Exam alignment\n\nISC² SSCP (Risk response; monitoring).', 25, 3);

-- ========== BH-GRC-2: LESSONS (Module 3 — Policy and Control Frameworks) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000007', 'd0000000-0000-4000-8000-000000000003', 'Policies, Standards, and Procedures', 'The hierarchy of governance documents.', E'# Policies, Standards, and Procedures\n\n## Introduction\n\nThis lesson explains the difference between policies, standards, and procedures and how they form a hierarchy of governance documents. You will learn how to write and maintain them so they are clear and enforceable.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Distinguish policies, standards, and procedures and give examples.\n- Describe the approval and review cycle for governance documents.\n- Explain how to make documents clear and auditable.\n\n## Policies\n\n**Policies** are high-level statements of what the organisation expects. They are approved by leadership (e.g. board or executive) and set the tone and direction. Examples: "The organisation protects confidential data"; "Access to systems is granted based on role and need." Policies do not specify technical details; they mandate outcomes and accountability. They are relatively stable and reviewed periodically (e.g. annually).\n\n## Standards\n\n**Standards** define specific requirements that support policies. They may be set by the organisation or by external bodies (e.g. password length, encryption algorithms, retention periods). Standards are more detailed than policies and may change more often as technology or regulation changes. Example: "Passwords must be at least 12 characters and include complexity requirements."\n\n## Procedures\n\n**Procedures** (or runbooks) are step-by-step instructions for performing tasks. They ensure consistency and support training and audits. Examples: how to grant access, how to handle an incident, how to conduct a risk assessment. Procedures should be clear, actionable, and updated when processes change.\n\n## Hierarchy and Traceability\n\nPolicies drive standards; standards drive procedures. Controls implemented in the organisation should be traceable to a policy or standard. This traceability supports audits: auditors can follow from policy to control to evidence.\n\n## Key takeaway\n\nPolicies set direction; standards set requirements; procedures set steps. Maintain clear hierarchy and traceability for accountability and audits.\n\n## Exam alignment\n\nISC² SSCP (Policies; security program).', 24, 1),
  ('e0000000-0000-4000-8000-000000000008', 'd0000000-0000-4000-8000-000000000003', 'Control Frameworks', 'Using NIST, ISO, and other frameworks.', E'# Control Frameworks\n\n## Introduction\n\nThis lesson introduces common control frameworks that organisations use to structure their security and compliance efforts. You will learn how frameworks are used and how to map controls to requirements.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Name and describe the purpose of common frameworks (e.g. NIST, ISO).\n- Explain how organisations select and apply frameworks.\n- Map organisational controls to framework requirements.\n\n## Why Frameworks\n\nFrameworks provide a structured set of controls and practices so organisations do not start from scratch. They reflect industry and regulatory expectations and support consistency and benchmarking. Many regulations and contracts reference or require alignment with a framework.\n\n## NIST\n\nThe **NIST Cybersecurity Framework (CSF)** and **NIST SP 800-53** are widely used. The CSF has five functions: Identify, Protect, Detect, Respond, Recover. It is risk-based and adaptable to sector and size. NIST SP 800-53 is a catalogue of controls used by US federal and many other organisations. Controls are grouped by family (e.g. access control, audit).\n\n## ISO/IEC 27001\n\n**ISO/IEC 27001** is an international standard for information security management systems (ISMS). It requires the organisation to define scope, assess risk, select controls from ISO 27002 (Annex A), and implement, monitor, and improve. Certification involves an external audit. Many organisations use it to demonstrate a structured security programme.\n\n## Other Frameworks\n\n**CIS Controls** are a prioritised set of actions for defence. **COBIT** focuses on IT governance and management. **PCI-DSS** applies to payment card data. Organisations often map one framework to another (e.g. NIST to ISO) to satisfy multiple requirements with one control set.\n\n## Using Frameworks in Practice\n\nSelect frameworks based on regulation, sector, and partner requirements. Map existing controls to the framework; identify gaps; prioritise remediation. Use the framework as a common language for risk and audit discussions.\n\n## Key takeaway\n\nFrameworks (NIST, ISO, CIS, etc.) provide a structured set of controls. Map organisational controls to frameworks to identify gaps and satisfy regulatory and partner requirements.\n\n## Exam alignment\n\nISC² SSCP (Security operations; control frameworks).', 26, 2),
  ('e0000000-0000-4000-8000-000000000009', 'd0000000-0000-4000-8000-000000000003', 'Security Controls and Control Types', 'Preventive, detective, corrective, and compensatory controls.', E'# Security Controls and Control Types\n\n## Introduction\n\nThis lesson covers the types of security controls and how they are classified by function and implementation. You will learn how to select and document controls for risk treatment and compliance.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Classify controls by function: preventive, detective, corrective, deterrent, compensatory.\n- Classify controls by implementation: technical, administrative, physical.\n- Document controls for risk and compliance purposes.\n\n## Control Functions\n\n**Preventive** controls stop an incident from occurring (e.g. firewall blocks unauthorised access; access control prevents unauthorised users). **Detective** controls identify when something has happened (e.g. IDS alerts, logging, audit trails). **Corrective** controls fix or limit damage after an incident (e.g. patches, backups, incident response). **Deterrent** controls discourage attacks (e.g. warnings, visible monitoring). **Compensating** controls are alternatives when a primary control cannot be applied (e.g. extra monitoring when a patch cannot be installed).\n\n## Technical, Administrative, Physical\n\n**Technical** controls are implemented in technology (firewalls, encryption, access controls). **Administrative** controls are policies, procedures, and training. **Physical** controls protect facilities and hardware (locks, badges, environmental controls). A complete programme uses all three; defence in depth layers multiple controls.\n\n## Documenting Controls\n\nFor each control, document: name and description; type (preventive/detective/etc. and technical/administrative/physical); which risk or requirement it addresses; owner; how it is tested or evidenced. This supports risk registers, compliance mapping, and audits.\n\n## Key takeaway\n\nControls can be classified by function (prevent, detect, correct, deter, compensate) and implementation (technical, administrative, physical). Document controls clearly for risk and compliance.\n\n## Exam alignment\n\nISC² SSCP (Security controls; implementation).', 22, 3);

-- ========== BH-GRC-2: LESSONS (Module 4 — Compliance and Audit) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-00000000000a', 'd0000000-0000-4000-8000-000000000004', 'Compliance Programmes', 'Building and running a compliance programme.', E'# Compliance Programmes\n\n## Introduction\n\nThis lesson covers how to build and run a compliance programme: identifying obligations, mapping controls, collecting evidence, and managing findings. You will learn the lifecycle of compliance and how it interacts with risk and audit.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- List typical compliance obligations (legal, regulatory, contractual).\n- Describe how to map controls to requirements and collect evidence.\n- Explain how to prioritise and remediate compliance gaps.\n\n## Compliance Obligations\n\nOrganisations must comply with **laws** (e.g. data protection, sector-specific regulation), **regulatory** requirements (e.g. financial services, healthcare), and **contractual** obligations (e.g. security and privacy clauses in customer or vendor contracts). Maintain an inventory of obligations, owners, and due dates (e.g. audit deadlines, renewal dates).\n\n## Mapping and Evidence\n\n**Mapping** links each obligation to the controls that satisfy it. One control may satisfy multiple requirements; one requirement may need several controls. **Evidence** is the proof that controls are in place and operating: screenshots, reports, logs, policy documents, training records. Collect and store evidence in a structured way so it can be retrieved for audits and reviews.\n\n## Gap Management\n\nA **gap** is a requirement that is not fully satisfied. Identify gaps through self-assessment or internal audit; prioritise by risk and regulatory impact; remediate with a plan (owner, deadline, verification). Track gaps in a register and escalate when deadlines are missed or risk is high.\n\n## Key takeaway\n\nA compliance programme identifies obligations, maps controls, collects evidence, and manages gaps. Structure and consistency support audits and reduce regulatory risk.\n\n## Exam alignment\n\nISC² SSCP (Compliance; security program).', 25, 1),
  ('e0000000-0000-4000-8000-00000000000b', 'd0000000-0000-4000-8000-000000000004', 'Internal and External Audit', 'How audits work and how to prepare.', E'# Internal and External Audit\n\n## Introduction\n\nThis lesson explains how internal and external audits work, what auditors look for, and how to prepare. You will learn the audit lifecycle and how to respond to findings.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Distinguish internal from external audit and describe their purposes.\n- Explain the audit process: planning, fieldwork, reporting, follow-up.\n- Describe how to prepare for an audit and respond to findings.\n\n## Internal vs External Audit\n\n**Internal audit** is performed by or for the organisation to assess control effectiveness and support improvement. It is independent of the functions it audits and reports to the board or audit committee. **External audit** is performed by a third party (e.g. for certification, regulatory requirement, or customer assurance). External auditors provide an independent opinion; they may certify (e.g. ISO 27001) or report on control design and operation.\n\n## Audit Process\n\n**Planning** — Scope, criteria (e.g. framework or regulation), and schedule are agreed. **Fieldwork** — Auditors request evidence, interview staff, and test controls. **Reporting** — Findings (gaps, weaknesses) are documented with severity and recommendation. **Follow-up** — Management responds with remediation plans; auditors may verify closure. Prepare by ensuring evidence is organised, current, and traceable to requirements; designate a point of contact; be transparent and responsive.\n\n## Responding to Findings\n\nAccept the finding or contest with evidence; assign an owner and deadline for remediation; implement fixes and collect evidence; request closure when complete. Track findings in a register so nothing is lost and senior management can monitor progress.\n\n## Key takeaway\n\nInternal audit supports improvement; external audit provides independent assurance. Prepare with organised evidence and clear ownership; respond to findings with plans and follow-through.\n\n## Exam alignment\n\nISC² SSCP (Audit; compliance).', 24, 2),
  ('e0000000-0000-4000-8000-00000000000c', 'd0000000-0000-4000-8000-000000000004', 'Reporting and Metrics', 'Reporting risk and compliance to leadership.', E'# Reporting and Metrics\n\n## Introduction\n\nThis lesson covers how to report risk and compliance status to leadership and the board. You will learn what metrics to use and how to present them so decisions can be made.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Choose metrics that reflect risk and compliance health.\n- Structure reports for different audiences (executives, board).\n- Explain how reporting supports accountability and decisions.\n\n## Metrics for GRC\n\nUseful metrics include: **risk** — number of open high/critical risks, trend over time, ageing of open items; **compliance** — audit findings open/closed, control test pass rates, certification status; **operations** — incidents, mean time to detect/remediate, control coverage. Metrics should be consistent, measurable, and actionable. Avoid vanity metrics that do not drive decisions.\n\n## Reporting Structure\n\n**Executive reports** are concise: status (red/amber/green or similar), key metrics, top risks, and asks (decisions or resources needed). **Board reports** are high-level: strategic risk, compliance posture, major incidents or audits, and trend. Tailor detail to the audience; put the main message first; use visuals where they clarify.\n\n## Accountability\n\nReporting creates accountability: when leadership sees open risks or audit findings, they can prioritise and hold owners to account. Regular reporting (e.g. monthly or quarterly) keeps risk and compliance visible and supports a culture of continuous improvement.\n\n## Key takeaway\n\nReport risk and compliance with clear metrics and structure. Tailor reports to the audience; use reporting to drive accountability and decisions.\n\n## Exam alignment\n\nISC² SSCP (Reporting; security operations).', 20, 3);

-- ========== BH-SPEC-IAM: MODULES ==========
INSERT INTO public.modules (id, course_id, title, description, order_index) VALUES
  ('d0000000-0000-4000-8000-000000000011', 'a0000000-0000-4000-8000-000000000009', 'IAM Fundamentals', 'Identity, authentication, authorization, and directory services.', 1),
  ('d0000000-0000-4000-8000-000000000012', 'a0000000-0000-4000-8000-000000000009', 'Access Control Models and Mechanisms', 'DAC, MAC, RBAC, ABAC, MFA, and privileged access.', 2),
  ('d0000000-0000-4000-8000-000000000013', 'a0000000-0000-4000-8000-000000000009', 'Identity Lifecycle and Federation', 'Provisioning, deprovisioning, SSO, and federation.', 3),
  ('d0000000-0000-4000-8000-000000000014', 'a0000000-0000-4000-8000-000000000009', 'IAM in Practice', 'Zero trust, cloud IAM, monitoring, and incident response.', 4);

-- ========== BH-SPEC-IAM: LESSONS (Module 1) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000011', 'd0000000-0000-4000-8000-000000000011', 'Identity, Authentication, and Authorization', 'Core IAM concepts defined.', E'# Identity, Authentication, and Authorization\n\n## Introduction\n\nThis lesson defines identity, authentication, and authorization and how they work together. You will learn the difference between "who you are", "proving it", and "what you can do".\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define identity, authentication, and authorization.\n- Explain how they work together in access decisions.\n- Give examples of each in enterprise systems.\n\n## Identity\n\n**Identity** is the set of attributes that describe an entity (person, system, or service) in a way that can be used for access and accountability. In enterprises, identities are often represented in a directory (e.g. Active Directory, LDAP) with attributes such as name, email, role, and group membership. Identities can be for humans (user accounts) or machines (service accounts, API credentials). Strong identity management ensures each entity has one consistent identity and that it is accurate and up to date.\n\n## Authentication\n\n**Authentication** is the process of verifying that an entity is who or what it claims to be. It answers: "Are you really this identity?" Methods include something you know (password), something you have (token, smart card), and something you are (biometrics). Multi-factor authentication (MFA) combines two or more factors to reduce the risk of credential theft. Authentication typically happens at login; session management and re-authentication protect against session hijacking.\n\n## Authorization\n\n**Authorization** is the process of determining what an authenticated identity is allowed to do. It answers: "Given who you are, what resources and actions are you permitted?" Authorization is enforced by access control mechanisms (e.g. permissions, roles, policies) and is checked each time a resource is accessed. It is distinct from authentication: you must first prove who you are, then the system decides what you can access.\n\n## Key takeaway\n\nIdentity is who you are; authentication proves it; authorization decides what you can do. All three are needed for secure access.\n\n## Exam alignment\n\nCISSP (Identity and Access Management).', 26, 1),
  ('e0000000-0000-4000-8000-000000000012', 'd0000000-0000-4000-8000-000000000011', 'Directory Services and Identity Stores', 'How directories store and expose identity data.', E'# Directory Services and Identity Stores\n\n## Introduction\n\nThis lesson covers how directory services and identity stores hold and expose identity and group data. You will learn the role of directories in authentication and authorization and how to secure them.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Describe what a directory service is and common protocols (LDAP, AD).\n- Explain how applications use directories for authentication and lookup.\n- List security considerations for directory design and access.\n\n## Directory Services\n\nA **directory** is a specialised database optimised for read-heavy, hierarchical data such as users, groups, and attributes. **LDAP** (Lightweight Directory Access Protocol) is a standard protocol for querying and updating directories. **Active Directory (AD)** is Microsoft''s directory and identity platform; it integrates with Kerberos for authentication and Group Policy for configuration. Directories are central to enterprise IAM: they are the source of truth for identity and group membership.\n\n## Identity Stores\n\n**Identity stores** hold credentials (e.g. password hashes) and attributes. They may be part of the directory (e.g. AD) or separate (e.g. a dedicated identity provider). Applications may authenticate against the directory directly or through an intermediary (e.g. federation, SSO). Replication and redundancy are important for availability; backup and recovery procedures must protect directory data.\n\n## Security Considerations\n\nProtect the directory as a high-value asset: restrict who can read and modify it; use strong authentication for admin access; encrypt data in transit and at rest; monitor for anomalous queries or changes. Compromise of the directory can lead to broad access loss or privilege escalation.\n\n## Key takeaway\n\nDirectories and identity stores are the backbone of enterprise IAM. Secure them rigorously and understand how applications depend on them.\n\n## Exam alignment\n\nCISSP (Identity and Access Management; directory services).', 24, 2),
  ('e0000000-0000-4000-8000-000000000013', 'd0000000-0000-4000-8000-000000000011', 'Federation and Trust', 'Trust relationships and federated identity.', E'# Federation and Trust\n\n## Introduction\n\nThis lesson introduces federated identity and trust relationships between organisations or domains. You will learn how federation enables single sign-on and secure access across boundaries.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define federated identity and when it is used.\n- Explain trust relationships and identity providers vs service providers.\n- Describe protocols and standards used in federation (e.g. SAML, OAuth, OIDC).\n\n## Federated Identity\n\n**Federation** allows one organisation to trust another''s authentication. A user authenticates once to their home organisation (identity provider, IdP); the IdP asserts the user''s identity to other applications or organisations (service providers, SPs). This reduces the need for separate accounts and passwords in each system and centralises authentication at the IdP.\n\n## Identity Provider and Service Provider\n\nThe **identity provider (IdP)** authenticates the user and issues an assertion or token. The **service provider (SP)** (or relying party) receives the assertion and grants access based on it. Trust is established through metadata exchange, certificates, and agreements. The SP trusts the IdP to authenticate correctly and to release only appropriate attributes.\n\n## Protocols\n\n**SAML** (Security Assertion Markup Language) is used in many enterprise and government federations; it uses XML assertions. **OAuth 2.0** is a framework for authorization (delegated access to resources); it is often used with **OpenID Connect (OIDC)** for authentication. OIDC adds an identity layer on top of OAuth. Choose protocol based on ecosystem (e.g. web vs mobile, enterprise vs consumer) and integration requirements.\n\n## Key takeaway\n\nFederation lets one organisation trust another''s authentication. IdPs and SPs work together via SAML, OAuth, or OIDC to enable single sign-on and secure cross-boundary access.\n\n## Exam alignment\n\nCISSP (Identity and Access Management; federation).', 25, 3);

-- ========== BH-SPEC-IAM: LESSONS (Module 2) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000014', 'd0000000-0000-4000-8000-000000000012', 'Access Control Models', 'DAC, MAC, RBAC, ABAC.', E'# Access Control Models\n\n## Introduction\n\nThis lesson covers the main access control models: discretionary, mandatory, role-based, and attribute-based. You will learn when each is used and how they affect security and operations.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define DAC, MAC, RBAC, and ABAC.\n- Compare their strengths and typical use cases.\n- Explain how role-based access is designed and maintained.\n\n## Discretionary Access Control (DAC)\n\nIn **DAC**, the owner of a resource decides who can access it. Permissions are granted to users or groups at the discretion of the resource owner. DAC is flexible and common in file systems and collaboration tools, but it can lead to inconsistent permissions and is harder to enforce central policy. Users may over-share or forget to revoke access.\n\n## Mandatory Access Control (MAC)\n\nIn **MAC**, the system enforces access based on labels (e.g. classification levels) assigned to subjects and objects. Users cannot override the policy; only authorised processes can change labels. MAC is used in high-security and government environments where data classification must be strictly enforced. It is less flexible than DAC but provides strong consistency.\n\n## Role-Based Access Control (RBAC)\n\nIn **RBAC**, access is granted through **roles**. Users are assigned roles; roles are assigned permissions. This simplifies administration: add or remove a role from a user instead of managing many permissions. Roles should reflect job function. Design roles to follow least privilege and avoid role explosion (too many roles). RBAC is widely used in enterprises and applications.\n\n## Attribute-Based Access Control (ABAC)\n\nIn **ABAC**, access is determined by **attributes** of the user, resource, action, and environment (e.g. time, location, device). Policies are expressed as rules over attributes (e.g. "Allow if user.department == resource.owner and time in business hours"). ABAC is flexible and can support fine-grained and context-aware decisions; it can be more complex to implement and manage. It is used in dynamic or cloud environments.\n\n## Key takeaway\n\nDAC is owner-driven; MAC is label-driven; RBAC is role-driven; ABAC is attribute-driven. Choose the model that fits your security and operational needs.\n\n## Exam alignment\n\nCISSP (Identity and Access Management; access control models).', 28, 1),
  ('e0000000-0000-4000-8000-000000000015', 'd0000000-0000-4000-8000-000000000012', 'Multi-Factor and Strong Authentication', 'MFA, passwordless, and phishing-resistant methods.', E'# Multi-Factor and Strong Authentication\n\n## Introduction\n\nThis lesson covers multi-factor authentication and stronger methods that resist phishing and credential theft. You will learn how to design and deploy MFA and when to use passwordless or hardware-backed methods.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Explain the three factors of authentication and why MFA reduces risk.\n- Describe MFA methods: SMS, app, token, FIDO.\n- Recommend MFA and passwordless options for different use cases.\n\n## Factors of Authentication\n\n**Something you know** — Passwords, PINs. Weak alone because they can be stolen or guessed. **Something you have** — Phone, hardware token, smart card. **Something you are** — Biometrics (fingerprint, face). MFA requires two or more factors from different categories. Even if a password is stolen, an attacker without the second factor is blocked (unless they phish the second factor too).\n\n## MFA Methods\n\n**SMS and voice** — One-time codes sent to the phone. Better than password-only but vulnerable to SIM swap and phishing. **Authenticator apps** — Time-based one-time passwords (TOTP) or push approval. Stronger than SMS. **Hardware tokens** — Dedicated devices that generate codes or support FIDO. **FIDO2/WebAuthn** — Passwordless or second-factor using public-key crypto; resistant to phishing because the credential is bound to the origin. Prefer FIDO or hardware tokens for high-privilege or high-risk users.\n\n## Passwordless and Phishing-Resistant\n\n**Passwordless** authentication removes the password and uses other factors (e.g. FIDO, biometrics). It reduces password-related risk and improves usability. **Phishing-resistant** MFA cannot be easily tricked by a fake site (e.g. FIDO). Use phishing-resistant MFA for administrators and sensitive access.\n\n## Key takeaway\n\nMFA significantly reduces risk; use multiple factors from different categories. Prefer FIDO or hardware tokens for high-privilege and phishing-resistant scenarios.\n\n## Exam alignment\n\nCISSP (Identity and Access Management; authentication).', 26, 2),
  ('e0000000-0000-4000-8000-000000000016', 'd0000000-0000-4000-8000-000000000012', 'Privileged Access Management', 'Managing and securing privileged accounts.', E'# Privileged Access Management\n\n## Introduction\n\nThis lesson covers privileged access management (PAM): who has admin rights, how they are controlled, and how to monitor and protect privileged accounts. You will learn PAM practices and tools.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define privileged access and why it needs special control.\n- Describe just-in-time and just-enough privilege.\n- Explain vaulting, session management, and monitoring for privileged access.\n\n## Why Privileged Access Matters\n\n**Privileged accounts** (administrators, service accounts, root) can change configuration, access sensitive data, and create or delete accounts. Compromise of a privileged account can lead to full system or domain compromise. Privileged access should be minimised, controlled, and monitored.\n\n## Just-in-Time and Just-Enough\n\n**Just-in-time (JIT)** access grants privilege only when needed and for a limited time, instead of standing access. **Just-enough privilege (JEP)** grants the minimum permission required for the task. Both reduce the attack surface and the window of abuse. Implement via approval workflows, time-bound access, and role design.\n\n## Vaulting and Session Management\n\n**Credential vaulting** stores privileged credentials in a secure store; users request release for a session rather than knowing the password. **Session management** records and can terminate privileged sessions; session recording supports audit and investigation. **Monitoring** detects anomalous use of privileged accounts (e.g. access at unusual times, bulk data access).\n\n## Key takeaway\n\nPrivileged access must be minimised (JIT, JEP), controlled (vaulting, approval), and monitored (sessions, behaviour). PAM reduces the risk of abuse and compromise.\n\n## Exam alignment\n\nCISSP (Identity and Access Management; privileged access).', 25, 3);

-- ========== BH-SPEC-IAM: LESSONS (Module 3) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000017', 'd0000000-0000-4000-8000-000000000013', 'Identity Lifecycle', 'Provisioning, changes, and deprovisioning.', E'# Identity Lifecycle\n\n## Introduction\n\nThis lesson covers the identity lifecycle from onboarding (provisioning) through changes (transfers, role changes) to offboarding (deprovisioning). You will learn how to keep access accurate and timely.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Describe the stages of the identity lifecycle.\n- Explain provisioning and deprovisioning processes and automation.\n- Address common gaps (orphaned accounts, delayed revocation).\n\n## Provisioning\n\n**Provisioning** is granting access when a user joins or when their role requires new access. It should be driven by HR or manager request and follow approval. Best practice: automate from a source of truth (e.g. HR system) so new hires get default access and role changes trigger access updates. This reduces manual error and delay.\n\n## Mid-Lifecycle Changes\n\nWhen a user changes role or department, access should be updated: add access for the new role, remove access that is no longer needed. When projects end or contracts expire, remove project-specific access. Regular access reviews (recertification) catch drift: managers confirm who still needs what.\n\n## Deprovisioning\n\n**Deprovisioning** is revoking access when a user leaves or when access is no longer needed. It should happen as soon as possible (same day for leavers). Revoke all access: accounts, group membership, federation, application access. Disable or delete accounts; for shared or service accounts, change credentials. Delayed deprovisioning is a major cause of insider and ex-employee risk.\n\n## Key takeaway\n\nManage the full lifecycle: provision from a trusted source, update on role change, deprovision immediately on exit. Automate and review to keep access accurate.\n\n## Exam alignment\n\nCISSP (Identity and Access Management; lifecycle).', 24, 1),
  ('e0000000-0000-4000-8000-000000000018', 'd0000000-0000-4000-8000-000000000013', 'Single Sign-On and Access Aggregation', 'SSO design and security.', E'# Single Sign-On and Access Aggregation\n\n## Introduction\n\nThis lesson covers single sign-on (SSO): how it works, benefits, and security considerations. You will learn how SSO reduces password fatigue and improves control while introducing central points to protect.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Explain how SSO works and the role of the identity provider.\n- Describe benefits (usability, centralised control) and risks (single point of failure).\n- Secure SSO: MFA, session policy, and monitoring.\n\n## How SSO Works\n\nWith **SSO**, the user signs in once to the identity provider; the IdP then asserts the user to multiple applications without asking for a password again. The user gets a better experience and the organisation can enforce one strong authentication (e.g. MFA) at the IdP for all apps. SSO can be implemented with federation (SAML, OIDC) or with a central IdP that applications trust.\n\n## Benefits and Risks\n\nBenefits: fewer passwords, consistent MFA, centralised access policy, easier offboarding (disable at IdP). Risks: the IdP is a high-value target; compromise can affect all connected apps. Mitigate with strong IdP security (MFA, hardening), session timeouts, and monitoring for anomalous logins.\n\n## Session and Token Security\n\nControl session lifetime and re-authentication for sensitive actions. Use short-lived tokens where possible; validate tokens and bind them to device or IP if appropriate. Monitor for token theft or replay (e.g. same token used from two locations).\n\n## Key takeaway\n\nSSO improves usability and centralises control but makes the IdP critical. Secure the IdP, enforce MFA, and manage sessions and tokens carefully.\n\n## Exam alignment\n\nCISSP (Identity and Access Management; SSO).', 22, 2),
  ('e0000000-0000-4000-8000-000000000019', 'd0000000-0000-4000-8000-000000000013', 'Federation in Practice', 'Designing and operating federated identity.', E'# Federation in Practice\n\n## Introduction\n\nThis lesson covers practical aspects of designing and operating federated identity: trust setup, attribute release, and common issues. You will learn how to implement federation securely.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Describe how to establish trust between IdP and SP (metadata, certs).\n- Explain attribute release and privacy (release only what is needed).\n- Troubleshoot common federation issues (expired certs, misconfiguration).\n\n## Establishing Trust\n\nTrust is established by exchanging metadata (endpoints, certificates) and agreeing on identifiers and attributes. Use secure channels for metadata; validate SP requests (e.g. correct redirect URIs). Certificates must be valid and renewed; expired certs are a common cause of federation failures. Document trust relationships and review them periodically.\n\n## Attribute Release\n\nThe IdP releases attributes (e.g. email, role) to the SP. Apply **minimal release**: only send attributes the SP needs. Consider privacy and regulation (e.g. data minimisation). Use contracts or policies to define what can be released and to whom.\n\n## Operations\n\nMonitor federation for errors (failed logins, misconfigurations). Use logging and analytics to detect abuse (e.g. token replay, unusual patterns). Plan for IdP outage: have a fallback or communicate downtime. Test after changes (cert rotation, attribute changes).\n\n## Key takeaway\n\nFederation in practice requires secure trust setup, minimal attribute release, and solid operations (monitoring, cert management, testing).\n\n## Exam alignment\n\nCISSP (Identity and Access Management; federation).', 23, 3);

-- ========== BH-SPEC-IAM: LESSONS (Module 4) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-00000000001a', 'd0000000-0000-4000-8000-000000000014', 'IAM in Zero Trust', 'Identity as the perimeter.', E'# IAM in Zero Trust\n\n## Introduction\n\nThis lesson covers how identity and access fit into a zero trust architecture. You will learn how zero trust uses identity, device, and context to make access decisions and how IAM supports it.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Explain how zero trust changes the role of identity and access.\n- Describe continuous verification and least privilege in zero trust.\n- List IAM capabilities needed for zero trust (identity, device, policy).\n\n## Zero Trust and Identity\n\n**Zero trust** assumes no implicit trust based on network location. Every access request is verified. Identity is central: who is requesting, from what device, in what context (time, location, sensitivity of resource). IAM provides the identity signal and enforces policy (allow/deny, step-up MFA) at each request.\n\n## Continuous Verification\n\nAccess is not "grant once at login" but verified continuously. Session validity, device posture (e.g. patch level, encryption), and behaviour can trigger re-authentication or revocation. IAM and conditional access policies implement this: e.g. require MFA for sensitive apps, block access from unmanaged devices.\n\n## Least Privilege and Micro-Segmentation\n\nZero trust applies least privilege: grant only what is needed for the request. IAM supports this with fine-grained permissions, JIT access, and attribute-based policies. Micro-segmentation limits lateral movement; identity and device are used to allow or deny traffic to applications and data.\n\n## Key takeaway\n\nIn zero trust, identity is the primary control. IAM must support continuous verification, least privilege, and integration with device and context for every access decision.\n\n## Exam alignment\n\nCISSP (Identity and Access Management; zero trust).', 24, 1),
  ('e0000000-0000-4000-8000-00000000001b', 'd0000000-0000-4000-8000-000000000014', 'Cloud and Hybrid IAM', 'Identity across cloud and on-premises.', E'# Cloud and Hybrid IAM\n\n## Introduction\n\nThis lesson covers IAM in cloud and hybrid environments: cloud identity services, hybrid identity, and how to manage access consistently across on-premises and cloud.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Describe cloud identity services (e.g. Azure AD, AWS IAM) and how they differ from on-prem directories.\n- Explain hybrid identity (sync, federation) and when to use each.\n- Manage identities and access across cloud and on-premises.\n\n## Cloud Identity Services\n\nCloud providers offer their own identity and access services: **Azure Active Directory** (Azure AD / Entra ID) for Microsoft 365 and Azure; **AWS IAM** for AWS resources; **Google Cloud IAM** for GCP. They support users, groups, roles, and policies. They may sync with on-prem directories or act as the primary identity store for cloud-only users.\n\n## Hybrid Identity\n\n**Hybrid identity** connects on-premises directories with cloud. Options: **sync** (replicate users and groups to the cloud; may include password hash sync for seamless auth); **federation** (on-prem IdP authenticates; cloud trusts the IdP). Choose based on existing investment, compliance, and whether you need cloud-only users.\n\n## Consistency and Least Privilege\n\nApply the same principles in the cloud: least privilege, MFA, lifecycle management. Cloud IAM is often more granular (resource-level policies); use it to limit access to specific resources. Monitor cloud identity for misconfigurations and anomalous access.\n\n## Key takeaway\n\nCloud and hybrid IAM require understanding cloud identity services and how they integrate with on-prem. Apply consistent policies and least privilege across environments.\n\n## Exam alignment\n\nCISSP (Identity and Access Management; cloud IAM).', 25, 2),
  ('e0000000-0000-4000-8000-00000000001c', 'd0000000-0000-4000-8000-000000000014', 'IAM Monitoring and Incident Response', 'Detecting and responding to identity threats.', E'# IAM Monitoring and Incident Response\n\n## Introduction\n\nThis lesson covers how to monitor identity and access for threats and how to respond to identity-related incidents. You will learn what to log, what to detect, and how to contain and recover.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- List key IAM events to log and monitor (logins, permission changes, failures).\n- Describe indicators of identity compromise or abuse.\n- Outline response steps for credential compromise and privilege abuse.\n\n## What to Monitor\n\nLog and monitor: **authentication** — successful and failed logins, MFA events, password changes; **authorization** — permission changes, role assignments, access to sensitive resources; **lifecycle** — provisioning, deprovisioning, account lockouts. Correlate with other signals (e.g. impossible travel, access from new device).\n\n## Indicators of Compromise\n\nSigns of compromise or abuse: many failed logins then success; login from unusual location or device; privilege escalation; access to data or systems outside normal pattern; service account used interactively; dormant account suddenly active. Use analytics and UEBA (user and entity behaviour analytics) to surface anomalies.\n\n## Response\n\nFor **credential compromise**: revoke or reset credentials; force re-authentication or MFA; check for lateral movement and persistence. For **privilege abuse**: revoke excessive access; investigate what was accessed or changed; involve HR or legal if insider. Document and improve detection and controls.\n\n## Key takeaway\n\nMonitor IAM events and behaviour; detect anomalies and known attack patterns. Respond to credential compromise and abuse by revoking access, investigating, and improving controls.\n\n## Exam alignment\n\nCISSP (Identity and Access Management; monitoring and response).', 24, 3);

-- ========== BH-SPEC-CLOUD: MODULES ==========
INSERT INTO public.modules (id, course_id, title, description, order_index) VALUES
  ('d0000000-0000-4000-8000-000000000021', 'a0000000-0000-4000-8000-00000000000a', 'Cloud Security Fundamentals', 'Shared responsibility, cloud models, and threats.', 1),
  ('d0000000-0000-4000-8000-000000000022', 'a0000000-0000-4000-8000-00000000000a', 'Cloud Identity and Access', 'IAM in cloud, roles, policies, conditional access.', 2),
  ('d0000000-0000-4000-8000-000000000023', 'a0000000-0000-4000-8000-00000000000a', 'Cloud Infrastructure and Network Security', 'VPC, encryption, logging, and hardening.', 3),
  ('d0000000-0000-4000-8000-000000000024', 'a0000000-0000-4000-8000-00000000000a', 'Cloud Security Operations', 'CSPM, incident response, and compliance in cloud.', 4);

-- ========== BH-SPEC-CLOUD: LESSONS (Module 1) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000021', 'd0000000-0000-4000-8000-000000000021', 'Shared Responsibility Model', 'Who secures what in the cloud.', E'# Shared Responsibility Model\n\n## Introduction\n\nThis lesson explains the shared responsibility model: what the cloud provider secures versus what the customer must secure. You will learn how it differs by service type and how to avoid gaps.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Explain the shared responsibility model for IaaS, PaaS, and SaaS.\n- List customer responsibilities for each model.\n- Avoid common gaps (e.g. assuming the provider does everything).\n\n## Provider vs Customer\n\nThe **cloud provider** is responsible for the security **of** the cloud: physical infrastructure, hypervisor, and managed services. The **customer** is responsible for security **in** the cloud: their data, identity and access, network configuration, and how they use services. The exact split depends on the service: IaaS gives the customer more control and more responsibility; SaaS gives less control and less responsibility for the application layer.\n\n## IaaS, PaaS, SaaS\n\n**IaaS** — Provider secures physical, network, and hypervisor; customer secures OS, apps, data, identity, and network config (e.g. firewalls, subnets). **PaaS** — Provider adds OS and runtime; customer secures app, data, and identity. **SaaS** — Provider secures app and platform; customer secures identity, data classification, and usage policy. Always read the provider''s shared responsibility documentation; it varies by service.\n\n## Avoiding Gaps\n\nCommon gaps: leaving default credentials or open storage; misconfiguring network or identity; assuming encryption is automatic. Use checklists and governance (policy, scanning) to ensure customer responsibilities are met. Document your responsibility matrix for each workload.\n\n## Key takeaway\n\nThe shared responsibility model divides security between provider and customer. Know your responsibilities for each service and workload and implement them consistently.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (cloud concepts; shared responsibility).', 24, 1),
  ('e0000000-0000-4000-8000-000000000022', 'd0000000-0000-4000-8000-000000000021', 'Cloud Threats and Attack Vectors', 'Threats specific to cloud environments.', E'# Cloud Threats and Attack Vectors\n\n## Introduction\n\nThis lesson covers threats and attack vectors that are specific to or amplified in cloud environments. You will learn how to identify and mitigate them.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- List common cloud threats (misconfiguration, credential theft, supply chain).\n- Describe attack vectors (APIs, console, identity).\n- Apply mitigations: hardening, least privilege, monitoring.\n\n## Misconfiguration\n\n**Misconfiguration** is a leading cause of cloud incidents: storage buckets or databases left public; overly permissive IAM policies; unencrypted data; open management ports. Attackers scan for these. Mitigate with configuration baselines, automated checks (CSPM), and least privilege. Use infrastructure as code and peer review for changes.\n\n## Identity and Credential Theft\n\nCloud identity (console logins, API keys, role assumptions) is a prime target. Stolen credentials can be used to access data, spin up resources, or move laterally. Mitigate with MFA, short-lived credentials, and role-based access with minimal permissions. Rotate keys; avoid long-lived secrets. Monitor for anomalous identity activity.\n\n## Supply Chain and Third-Party\n\n**Supply chain** risk in cloud includes vulnerable or malicious images, libraries, and SaaS integrations. **Third-party** risk includes misconfigured or compromised integrations. Mitigate with image scanning, dependency checks, and strict approval of third-party access. Assume breach and segment; limit blast radius.\n\n## Key takeaway\n\nCloud threats include misconfiguration, identity theft, and supply chain. Harden configuration, protect identity, and monitor and segment to reduce impact.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (threats; cloud security).', 26, 2),
  ('e0000000-0000-4000-8000-000000000023', 'd0000000-0000-4000-8000-000000000021', 'Cloud Security Posture and Governance', 'Policy, baseline, and continuous assurance.', E'# Cloud Security Posture and Governance\n\n## Introduction\n\nThis lesson covers how to establish and maintain a strong security posture in the cloud through policy, baselines, and continuous assurance. You will learn governance patterns and tools.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define cloud security posture and how it is measured.\n- Use policy and baselines to set expectations (e.g. encryption, networking).\n- Describe CSPM and continuous compliance.\n\n## Security Posture\n\n**Security posture** is the overall state of security: how well configuration and controls align with policy and best practice. It is measured by assessing configuration (e.g. are buckets encrypted? Are networks segmented?) and comparing to a baseline. Posture degrades over time as changes are made; continuous assessment is needed.\n\n## Policy and Baselines\n\nDefine **policy** for the cloud: what is allowed (e.g. regions, services), what is required (e.g. encryption, logging), and what is forbidden (e.g. public storage). **Baselines** are specific configuration standards (e.g. CIS benchmarks for cloud). Enforce via guardrails (prevent bad config) and detection (find and fix). Use account and organisation structure to apply policy consistently.\n\n## CSPM and Continuous Compliance\n\n**Cloud Security Posture Management (CSPM)** tools scan cloud configuration and compare to policy and benchmarks. They report misconfigurations and compliance drift. Use them continuously, not only at deploy time. **Continuous compliance** means always measuring against frameworks (e.g. CIS, regulatory) and remediating gaps. Automate where possible.\n\n## Key takeaway\n\nStrong cloud posture requires clear policy, baselines, and continuous assessment (CSPM) and compliance. Automate checks and remediation to keep posture high.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (posture; governance).', 25, 3);

-- ========== BH-SPEC-CLOUD: LESSONS (Modules 2–4) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000024', 'd0000000-0000-4000-8000-000000000022', 'Cloud IAM and Roles', 'Users, roles, and policies in the cloud.', E'# Cloud IAM and Roles\n\n## Introduction\n\nThis lesson covers identity and access in the cloud: users, roles, service accounts, and policy. You will learn how to design least-privilege access for workloads and humans.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Explain the difference between users, roles, and service accounts in major clouds.\n- Write and apply policies that follow least privilege.\n- Use roles for workloads and avoid long-lived keys where possible.\n\n## Users, Roles, and Service Accounts\n\n**Users** (or identities) represent people or applications. **Roles** are permissions that can be assumed; they do not have permanent credentials. **Service accounts** (or similar) are identities for applications and workloads. Prefer **role-based** access for workloads: the workload assumes a role and gets temporary credentials; no long-lived keys to steal. For humans, use strong authentication and assign roles or groups with minimal permissions.\n\n## Policies\n\n**Policies** define what actions are allowed on what resources. They are often expressed as "effect, action, resource, condition". Use **least privilege**: grant only the actions and resources needed. Avoid wildcards unless necessary. Use **conditions** (e.g. IP, MFA) to further restrict. Review policies regularly; remove unused permissions.\n\n## Key takeaway\n\nCloud IAM uses users, roles, and policies. Prefer roles for workloads; apply least privilege and conditions; avoid long-lived keys.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (identity and access in cloud).', 24, 1),
  ('e0000000-0000-4000-8000-000000000025', 'd0000000-0000-4000-8000-000000000022', 'Conditional Access and Zero Trust in Cloud', 'Context-aware access control.', E'# Conditional Access and Zero Trust in Cloud\n\n## Introduction\n\nThis lesson covers conditional access and zero trust in the cloud: using device, location, and risk to allow or deny access. You will learn how to design and implement conditional policies.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define conditional access and how it differs from static rules.\n- Use signals: device, location, risk, sensitivity.\n- Design policies that balance security and usability.\n\n## Conditional Access\n\n**Conditional access** evaluates each request against conditions (e.g. user from managed device, from corporate network, low risk). If conditions are met, access is granted; otherwise access is blocked or step-up (e.g. MFA) is required. This enables "allow from trusted context, require more proof otherwise" without blocking everyone.\n\n## Signals and Policy\n\nSignals include: **device** (managed, compliant, encrypted); **location** (IP, country); **risk** (sign-in risk, user risk from behaviour); **sensitivity** of the resource. Policies combine signals: e.g. "Allow access to sensitive app only from managed device and with MFA." Start with high-sensitivity resources and expand. Test to avoid locking out users.\n\n## Key takeaway\n\nConditional access uses device, location, and risk to make access decisions. Design policies that protect sensitive resources while allowing legitimate use.\n\n## Exam alignment\n\nMicrosoft SC-200 (conditional access; identity).', 22, 2),
  ('e0000000-0000-4000-8000-000000000026', 'd0000000-0000-4000-8000-000000000022', 'Securing Cloud Data', 'Encryption, classification, and DLP.', E'# Securing Cloud Data\n\n## Introduction\n\nThis lesson covers how to protect data in the cloud: encryption at rest and in transit, classification, and data loss prevention. You will learn provider and customer responsibilities for data security.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Apply encryption at rest and in transit for cloud data.\n- Use classification and labelling to protect sensitive data.\n- Describe DLP and retention in the cloud.\n\n## Encryption\n\n**At rest**: Use provider or customer-managed encryption for storage and databases; understand key management (provider-managed vs customer-managed keys). **In transit**: TLS for all traffic; avoid plaintext between services. Enforce encryption via policy and configuration checks.\n\n## Classification and DLP\n\n**Classification** labels data by sensitivity (e.g. public, internal, confidential). Use labels to apply policies (e.g. encryption, access, retention). **Data loss prevention (DLP)** detects or blocks sensitive data from leaving defined boundaries (e.g. block upload of PII to personal email). Use classification and DLP together to protect data wherever it lives.\n\n## Key takeaway\n\nEncrypt data at rest and in transit; classify data and apply policy; use DLP to prevent inappropriate exposure or exfiltration.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (data protection).', 23, 3),
  ('e0000000-0000-4000-8000-000000000027', 'd0000000-0000-4000-8000-000000000023', 'Network Security in the Cloud', 'VPC, firewalls, and segmentation.', E'# Network Security in the Cloud\n\n## Introduction\n\nThis lesson covers network security in the cloud: virtual networks, firewalls, segmentation, and secure connectivity. You will learn how to design and operate secure cloud networks.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Design VPCs and subnets for segmentation and least privilege.\n- Use security groups, NACLs, and firewalls to control traffic.\n- Implement secure connectivity (VPN, private link).\n\n## VPC and Segmentation\n\n**Virtual networks** (VPC, VNet) isolate your resources. Use **subnets** to segment (e.g. public, private, data). Place only what must be public in public subnets; use private subnets and NAT for outbound-only access. Segment by workload or trust zone so a breach in one segment does not expose everything.\n\n## Security Groups and Firewalls\n\n**Security groups** (or similar) act as stateful firewalls at the instance or interface level. Allow only required traffic (e.g. 443 from load balancer to app tier). **Network ACLs** add subnet-level stateless rules. **Web application firewalls (WAF)** protect HTTP/HTTPS. Use layered controls: WAF for web, security groups for instance, NACL for subnet.\n\n## Key takeaway\n\nSegment with VPC and subnets; control traffic with security groups and firewalls; use secure connectivity for hybrid and partner access.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (network security).', 24, 1),
  ('e0000000-0000-4000-8000-000000000028', 'd0000000-0000-4000-8000-000000000023', 'Logging and Monitoring in the Cloud', 'Centralised logging and detection.', E'# Logging and Monitoring in the Cloud\n\n## Introduction\n\nThis lesson covers logging and monitoring in the cloud: what to log, how to centralise and retain logs, and how to use them for detection and response. You will learn cloud-native and hybrid approaches.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Enable and collect key logs (identity, network, resource, audit).\n- Centralise logs and protect them from tampering.\n- Use logs for alerting, detection, and investigation.\n\n## What to Log\n\nLog **identity** (sign-ins, permission changes), **network** (flow logs, firewall), **resource** (API calls, configuration changes), and **application** logs. Ensure logs include enough context (user, resource, timestamp, result). Many clouds have central audit logs (e.g. CloudTrail, Azure Activity); enable them and send to a secure store.\n\n## Centralisation and Retention\n\nSend logs to a central store (e.g. SIEM, cloud log analytics) so they can be correlated and retained per policy. Protect the log store: restrict write/delete, encrypt, and consider immutability. Retain according to regulation and incident response needs.\n\n## Detection and Response\n\nUse logs for **alerting** (thresholds, known-bad patterns) and **detection** (analytics, anomaly). Integrate with incident response: when an alert fires, runbooks and playbooks guide investigation and containment. Test detection and response regularly.\n\n## Key takeaway\n\nLog identity, network, and resource activity; centralise and protect logs; use them for detection and response.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (logging; monitoring).', 23, 2),
  ('e0000000-0000-4000-8000-000000000029', 'd0000000-0000-4000-8000-000000000023', 'Containers and Serverless Security', 'Securing modern workload types.', E'# Containers and Serverless Security\n\n## Introduction\n\nThis lesson covers security for containers and serverless workloads: image and function security, runtime protection, and supply chain. You will learn how to secure these common cloud patterns.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Secure container images (scanning, base images, supply chain).\n- Apply runtime security for containers and functions.\n- Describe serverless-specific risks and controls.\n\n## Container Security\n\n**Images**: Use minimal base images; scan for vulnerabilities; sign and verify images. **Runtime**: Run as non-root; use read-only filesystem where possible; limit capabilities. **Orchestration**: Secure the control plane; use network policies; restrict pod-to-pod and external access. **Supply chain**: Use trusted registries; verify image provenance.\n\n## Serverless Security\n\n**Functions** (e.g. Lambda, Azure Functions): Apply least privilege to function roles; do not store secrets in code; use short timeouts and minimal permissions. **Event sources**: Validate and sanitise inputs; protect event queues. **Dependencies**: Scan and update libraries. Serverless reduces OS management but shifts focus to identity, code, and data.\n\n## Key takeaway\n\nContainers and serverless need image/function security, runtime protection, and supply chain controls. Apply least privilege and secure the full pipeline.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (workload security).', 25, 3),
  ('e0000000-0000-4000-8000-00000000002a', 'd0000000-0000-4000-8000-000000000024', 'Cloud Incident Response', 'Detecting and responding to cloud incidents.', E'# Cloud Incident Response\n\n## Introduction\n\nThis lesson covers incident response in the cloud: detection, containment, and recovery. You will learn how cloud changes some aspects of IR and how to prepare.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Detect incidents using cloud logs and native tools.\n- Contain by isolating resources, revoking access, and disabling accounts.\n- Recover and verify; use automation where appropriate.\n\n## Detection\n\nUse cloud audit logs, flow logs, and security tools to detect anomalies and known-bad activity. Correlate with identity, network, and resource changes. Have playbooks for common scenarios (e.g. compromised credential, crypto mining, data exfiltration).\n\n## Containment\n\nContain by: **isolating** affected resources (e.g. detach from network, disable); **revoking** compromised credentials and roles; **blocking** malicious IPs or domains at WAF or firewall. In cloud, you can do this quickly via API; automate critical containment steps. Preserve evidence (logs, snapshots) before making destructive changes.\n\n## Recovery and Lessons Learned\n\nRecover by rebuilding from known-good images or restoring from backup; verify integrity. Update configurations and credentials. Document timeline and root cause; update detection and controls to prevent recurrence.\n\n## Key takeaway\n\nCloud IR uses cloud-native logs and tools for detection and containment. Prepare playbooks and automate where possible; preserve evidence and learn from each incident.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (incident response).', 24, 1),
  ('e0000000-0000-4000-8000-00000000002b', 'd0000000-0000-4000-8000-000000000024', 'Compliance and Assurance in the Cloud', 'Meeting regulatory and audit requirements.', E'# Compliance and Assurance in the Cloud\n\n## Introduction\n\nThis lesson covers how to achieve and demonstrate compliance in the cloud: frameworks, evidence, and audits. You will learn how providers and customers share compliance responsibilities.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Use provider compliance programmes and certifications.\n- Map customer controls to frameworks and collect evidence.\n- Prepare for and support audits in the cloud.\n\n## Provider Compliance\n\nCloud providers publish compliance certifications (e.g. SOC 2, ISO 27001, sector-specific). Use them to understand what the provider has been audited for. Your compliance still depends on how you use the cloud: your configuration, identity, and data. Provider certifications reduce but do not remove your burden.\n\n## Customer Controls and Evidence\n\nMap your controls (config, IAM, encryption, logging) to your framework (e.g. CIS, NIST, PCI). Collect evidence: configuration exports, logs, policy documents. Use CSPM and compliance tools to automate evidence collection and gap reporting. Maintain an inventory of in-scope resources and their compliance status.\n\n## Audits\n\nFor audits, provide evidence in an organised way; show traceability from requirement to control to evidence. Use provider audit reports where they cover shared controls. Document responsibilities and any gaps; have remediation plans.\n\n## Key takeaway\n\nCompliance in the cloud uses provider certifications and your own controls and evidence. Automate mapping and evidence; prepare for audits with clear documentation.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (compliance).', 22, 2),
  ('e0000000-0000-4000-8000-00000000002c', 'd0000000-0000-4000-8000-000000000024', 'Security Automation and DevSecOps in the Cloud', 'Automating security in CI/CD and operations.', E'# Security Automation and DevSecOps in the Cloud\n\n## Introduction\n\nThis lesson covers how to integrate security into cloud development and operations through automation, pipeline checks, and DevSecOps practices. You will learn how to shift left and maintain security at speed.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Integrate security checks into CI/CD pipelines (scanning, policy as code).\n- Use infrastructure as code to enforce and audit configuration.\n- Describe DevSecOps culture and tooling in the cloud.\n\n## Security in the Pipeline\n\n**Shift left** means finding and fixing issues early: in code, in dependencies, and at deploy time. In CI/CD, run **SAST** (static analysis), **dependency scanning**, and **container/image scanning** before merge or deploy. Use **policy as code** to block deployments that violate security rules (e.g. public bucket, missing encryption). Failing the pipeline prevents insecure releases.\n\n## Infrastructure as Code\n\n**Infrastructure as code (IaC)** (e.g. Terraform, CloudFormation) defines environment and configuration in version-controlled files. Scan IaC for misconfigurations before apply; use approved modules and patterns. IaC makes configuration repeatable, auditable, and testable. Enforce tagging, networking, and encryption via IaC standards and automated checks.\n\n## DevSecOps Culture\n\n**DevSecOps** embeds security into development and operations: shared ownership, security as code, and automation. Use shared dashboards (e.g. CSPM, pipeline status) so teams see security posture. Balance speed and control: automate guardrails so secure is the default path; avoid bottlenecks that push work around security.\n\n## Key takeaway\n\nSecurity automation and DevSecOps in the cloud integrate scanning and policy into pipelines and IaC. Shift left and use automation so security keeps pace with delivery.\n\n## Exam alignment\n\nAWS Security; Microsoft SC-200 (automation; DevSecOps).', 24, 3);

-- ========== BH-SPEC-GRC (Advanced GRC): MODULES ==========
INSERT INTO public.modules (id, course_id, title, description, order_index) VALUES
  ('d0000000-0000-4000-8000-000000000031', 'a0000000-0000-4000-8000-00000000000b', 'Enterprise Risk Management', 'ERM framework, risk appetite, and board-level risk.', 1),
  ('d0000000-0000-4000-8000-000000000032', 'a0000000-0000-4000-8000-00000000000b', 'IT Risk Identification and Analysis', 'IT-specific risk scenarios and quantitative methods.', 2),
  ('d0000000-0000-4000-8000-000000000033', 'a0000000-0000-4000-8000-00000000000b', 'Risk Response and Monitoring', 'Response strategies, KRIs, and risk reporting.', 3),
  ('d0000000-0000-4000-8000-000000000034', 'a0000000-0000-4000-8000-00000000000b', 'Governance and Reporting', 'Risk governance, committees, and assurance.', 4);

-- ========== BH-SPEC-GRC: LESSONS (Module 1 — Enterprise Risk Management) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000031', 'd0000000-0000-4000-8000-000000000031', 'Enterprise Risk Management Frameworks', 'ERM concepts and how IT risk fits.', E'# Enterprise Risk Management Frameworks\n\n## Introduction\n\nThis lesson introduces enterprise risk management (ERM) and how IT and cyber risk sit within it. You will learn common ERM frameworks and the role of the risk function.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define ERM and how it differs from siloed risk management.\n- Name common ERM frameworks (e.g. COSO, ISO 31000).\n- Explain how IT and cyber risk are integrated into ERM.\n\n## What is ERM?\n\n**Enterprise risk management** is the discipline of identifying, assessing, responding to, and monitoring risk across the entire organisation in a coordinated way. It ensures that risk is considered at strategy and decision level and that appetite and tolerance are defined and communicated. ERM moves away from risk managed only within departments (e.g. IT, finance) toward a unified view that supports the board and executive.\n\n## Frameworks\n\n**COSO ERM** (Committee of Sponsoring Organizations) is widely used; it emphasises strategy, governance, and culture. **ISO 31000** is an international standard for risk management that can be applied to any organisation or risk type. Both support a cycle of identify, assess, treat, monitor, and communicate. IT and cyber risk are risk categories within ERM; they use the same language (appetite, tolerance, treatment) and feed into the same reporting.\n\n## Integrating IT Risk\n\nIT and cyber risk should be identified and assessed using the same ERM process: same risk register or linked registers, same severity scales, and reporting into the same committees. This allows leadership to see all risk in one place and to prioritise across operational, financial, and technology risk.\n\n## Key takeaway\n\nERM provides a unified approach to risk across the organisation. Use established frameworks and integrate IT and cyber risk into the same governance and reporting.\n\n## Exam alignment\n\nCRISC (Enterprise risk; ERM frameworks).', 26, 1),
  ('e0000000-0000-4000-8000-000000000032', 'd0000000-0000-4000-8000-000000000031', 'Risk Appetite and Tolerance', 'Defining how much risk the organisation accepts.', E'# Risk Appetite and Tolerance\n\n## Introduction\n\nThis lesson covers risk appetite and risk tolerance: how organisations define how much risk they are willing to accept and how that guides decisions. You will learn how to articulate and use appetite and tolerance in practice.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define risk appetite and risk tolerance and distinguish them.\n- Describe how appetite is set and communicated (board, statements).\n- Use tolerance to make accept/mitigate/avoid decisions.\n\n## Risk Appetite\n\n**Risk appetite** is the amount and type of risk the organisation is willing to take on in pursuit of its objectives. It is a strategic statement, often set by the board: e.g. "We accept moderate operational risk in exchange for growth but have low appetite for reputational or regulatory risk." Appetite is usually expressed at a high level (e.g. by category or impact type) and may be qualitative or linked to metrics.\n\n## Risk Tolerance\n\n**Risk tolerance** is the acceptable variation around objectives or the maximum level of risk for a specific area. It is more operational: e.g. "We tolerate up to X hours of unplanned downtime per year" or "We do not accept any unmitigated critical vulnerabilities in internet-facing systems." Tolerance is used to decide whether a specific risk is acceptable or must be treated. Breach of tolerance typically triggers escalation or mandatory treatment.\n\n## Using Appetite and Tolerance\n\nUse appetite to guide strategy and resource allocation; use tolerance to evaluate individual risks and control design. Report when risks approach or exceed tolerance; review appetite periodically (e.g. annually) and when strategy or environment changes.\n\n## Key takeaway\n\nRisk appetite sets strategic willingness to take risk; tolerance sets operational limits. Define both clearly and use them to drive consistent risk decisions.\n\n## Exam alignment\n\nCRISC (Risk appetite; tolerance).', 24, 2),
  ('e0000000-0000-4000-8000-000000000033', 'd0000000-0000-4000-8000-000000000031', 'Board and Executive Risk Reporting', 'Reporting risk to the board and C-suite.', E'# Board and Executive Risk Reporting\n\n## Introduction\n\nThis lesson covers how to report risk effectively to the board and executive team. You will learn what they need to fulfil their governance duties and how to present IT and cyber risk in that context.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- List what the board needs: top risks, trend, appetite/tolerance, decisions.\n- Structure board and executive risk reports.\n- Explain how IT risk fits into enterprise risk reporting.\n\n## Board Responsibilities\n\nThe board oversees strategy and risk; it does not manage day-to-day operations. It needs a clear view of **top risks**, **trend** (improving or worsening), **alignment with appetite and tolerance**, and **decisions required** (e.g. accept residual risk, approve investment). Reports should be concise, comparable over time, and focused on what the board can act on.\n\n## Report Structure\n\nTypical structure: **executive summary** (2–3 sentences); **risk landscape** (top risks, heat map or list); **metrics** (e.g. open critical risks, control coverage); **trend and outlook**; **decisions or asks** (e.g. approval for risk acceptance, budget). Avoid jargon; use business impact. Provide detail in appendices or on request.\n\n## IT and Cyber in the Picture\n\nIT and cyber risk should appear in the same report as other enterprise risks, with consistent severity and treatment status. Highlight systemic or strategic IT risks (e.g. resilience, major projects, regulatory). Ensure the board understands both likelihood and impact in business terms.\n\n## Key takeaway\n\nBoard and executive reporting should be clear, consistent, and decision-oriented. Integrate IT and cyber risk into enterprise risk reporting so leadership sees one picture.\n\n## Exam alignment\n\nCRISC (Governance; reporting).', 22, 3);

-- ========== BH-SPEC-GRC: LESSONS (Module 2 — IT Risk Identification and Analysis) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000034', 'd0000000-0000-4000-8000-000000000032', 'IT Risk Scenarios and Threat Modelling', 'Structured identification of IT risk.', E'# IT Risk Scenarios and Threat Modelling\n\n## Introduction\n\nThis lesson covers how to identify IT risk through scenarios and threat modelling. You will learn how to build realistic scenarios that link threats, vulnerabilities, and business impact.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Construct IT risk scenarios (threat, vulnerability, asset, impact).\n- Use threat modelling techniques (e.g. STRIDE, attack trees).\n- Prioritise scenarios for assessment and treatment.\n\n## Risk Scenarios\n\nA **risk scenario** describes a specific way harm could occur. For IT: "An attacker exploits a vulnerability in the web application to access customer data." Scenarios should name the threat, the vulnerability or vector, the asset at risk, and the impact. Good scenarios are concrete enough to assess and treat; they avoid vague "something could go wrong" statements.\n\n## Threat Modelling\n\n**Threat modelling** systematically identifies threats to a system or process. **STRIDE** (Spoofing, Tampering, Repudiation, Information disclosure, Denial of service, Elevation of privilege) is a common checklist. **Attack trees** break down how an attacker might achieve a goal (e.g. steal data) into steps and sub-steps. Use these to ensure coverage and to communicate with technical and business stakeholders.\n\n## Prioritisation\n\nNot all scenarios can be addressed first. Prioritise by likelihood and impact (risk level), alignment with strategic objectives, and regulatory or audit focus. Maintain a risk register and review scenarios when the environment or threat landscape changes.\n\n## Key takeaway\n\nIT risk scenarios and threat modelling give structure to risk identification. Use them to prioritise and to align technical and business views of risk.\n\n## Exam alignment\n\nCRISC (Risk identification; IT risk).', 26, 1),
  ('e0000000-0000-4000-8000-000000000035', 'd0000000-0000-4000-8000-000000000032', 'Quantitative Risk Analysis', 'Using numbers in risk assessment.', E'# Quantitative Risk Analysis\n\n## Introduction\n\nThis lesson covers quantitative risk analysis: using numbers (probability, impact in currency, expected loss) to assess and compare risk. You will learn when and how to apply quantitative methods.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define quantitative risk concepts (ALE, SLE, ARO).\n- Apply simple quantitative models to IT risk.\n- Understand limitations and when to use qualitative instead.\n\n## Key Concepts\n\n**SLE (Single Loss Expectancy)** is the expected loss if a risk event occurs once (e.g. cost of a data breach). **ARO (Annual Rate of Occurrence)** is how often the event is expected per year. **ALE (Annual Loss Expectancy)** = SLE × ARO; it is the expected loss per year. These support cost-benefit analysis: if the cost of a control is less than the reduction in ALE, the control may be justified.\n\n## Applying Quantitative Analysis\n\nGather data: historical incidents, industry benchmarks (e.g. breach cost studies), and expert estimates. Use ranges (e.g. low/medium/high impact) when point estimates are uncertain. Document assumptions and update when new data is available. Quantitative analysis is most useful when you have reasonable data and need to compare options (e.g. which control to fund).\n\n## Limitations\n\nData may be scarce or biased; rare but severe events are hard to quantify. Qualitative assessment is often more practical for many risks. Use quantitative where it adds value (e.g. business case for investment) and qualitative or hybrid elsewhere.\n\n## Key takeaway\n\nQuantitative risk analysis uses SLE, ARO, and ALE to support decisions. Use it where data and context allow; combine with qualitative methods as needed.\n\n## Exam alignment\n\nCRISC (Risk analysis; quantitative methods).', 25, 2),
  ('e0000000-0000-4000-8000-000000000036', 'd0000000-0000-4000-8000-000000000032', 'Control Design and Effectiveness', 'Designing and assessing controls.', E'# Control Design and Effectiveness\n\n## Introduction\n\nThis lesson covers how to design controls that reduce IT risk and how to assess whether they are effective. You will learn control design principles and testing methods.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Design controls that address risk and are testable.\n- Assess control effectiveness (design and operating effectiveness).\n- Identify control gaps and compensating controls.\n\n## Control Design\n\nControls should be **aligned to risk**: each control addresses one or more risk scenarios. They should be **specific** (clear what they do and who owns them) and **testable** (you can gather evidence that they operate as intended). Avoid controls that are vague or that no one can verify. Design with defence in depth where risk is high.\n\n## Assessing Effectiveness\n\n**Design effectiveness** asks: if the control operates as designed, would it reduce the risk? **Operating effectiveness** asks: does the control actually operate as designed? Test through inquiry, observation, and reperformance. Use sampling where populations are large. Document results and any exceptions; ineffective controls create residual risk that may need additional treatment.\n\n## Gaps and Compensating Controls\n\nA **gap** is a risk that is not fully covered by controls. **Compensating controls** are alternative controls when the primary control cannot be applied (e.g. extra monitoring when a patch cannot be installed). Document compensating controls and their limitations; review when the primary control becomes feasible.\n\n## Key takeaway\n\nControls must be well designed and tested. Assess both design and operating effectiveness; address gaps with additional or compensating controls.\n\n## Exam alignment\n\nCRISC (Control design; effectiveness).', 24, 3);

-- ========== BH-SPEC-GRC: LESSONS (Module 3 — Risk Response and Monitoring) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-000000000037', 'd0000000-0000-4000-8000-000000000033', 'Risk Response Strategies', 'Accept, mitigate, transfer, avoid in depth.', E'# Risk Response Strategies\n\n## Introduction\n\nThis lesson goes deeper into risk response strategies: when to accept, mitigate, transfer, or avoid risk, and how to document and approve each. You will learn how to align response with appetite and tolerance.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Choose and justify the right response strategy for a given risk.\n- Document risk acceptance and get appropriate approval.\n- Coordinate response with treatment plans and owners.\n\n## Accept\n\n**Accept** means the organisation consciously takes the risk without further action. Use when: impact is within appetite; cost of control exceeds benefit; or treatment is not feasible yet. **Document** acceptance: risk description, rationale, approver (often senior management or board for high risk), and review date. Do not use acceptance as a default for "we did not get to it"; that is untreated risk.\n\n## Mitigate, Transfer, Avoid\n\n**Mitigate** — Reduce likelihood or impact with controls; most common for IT risk. **Transfer** — Shift impact to another party (insurance, contract); does not remove the risk. **Avoid** — Stop the activity or exit the risk; use when risk is unacceptable. For each response, assign an owner, set a timeline, and define how you will verify effectiveness.\n\n## Alignment with Appetite\n\nResponses must align with stated appetite and tolerance. If a risk exceeds tolerance, acceptance is inappropriate without board-level decision and possible appetite change. Escalate when proposed response conflicts with policy or tolerance.\n\n## Key takeaway\n\nRisk response must be deliberate and documented. Match strategy to risk and appetite; ensure acceptance is explicit and approved; track treatment to completion.\n\n## Exam alignment\n\nCRISC (Risk response; treatment).', 24, 1),
  ('e0000000-0000-4000-8000-000000000038', 'd0000000-0000-4000-8000-000000000033', 'Key Risk Indicators and Monitoring', 'KRIs and continuous risk monitoring.', E'# Key Risk Indicators and Monitoring\n\n## Introduction\n\nThis lesson covers key risk indicators (KRIs) and how to use them for continuous risk monitoring. You will learn how to define, track, and act on KRIs.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Define KRIs and how they differ from KPIs.\n- Select and define KRIs for IT and cyber risk.\n- Use KRIs in reporting and escalation.\n\n## What are KRIs?\n\n**Key risk indicators** are metrics that signal increasing risk exposure before an incident occurs. They are leading or concurrent indicators (e.g. number of unpatched critical systems, failed access attempts). **KPIs** measure performance or outcome; **KRIs** measure risk. Good KRIs are measurable, timely, and actionable; when a KRI breaches a threshold, it triggers review or action.\n\n## Defining KRIs\n\nLink KRIs to risk scenarios: e.g. for "breach of customer data," a KRI might be "number of systems with unencrypted PII" or "percentage of critical systems patched within SLA." Set **thresholds**: green (acceptable), amber (watch), red (escalate or act). Review KRIs periodically; retire those that no longer reflect risk.\n\n## Using KRIs\n\nReport KRIs in risk dashboards and committee packs. When a KRI turns amber or red, investigate cause and decide: treat the risk, accept temporarily with a plan, or escalate. KRIs support a proactive risk culture: act before loss occurs.\n\n## Key takeaway\n\nKRIs signal risk exposure; use them with clear thresholds and escalation so the organisation can act before incidents.\n\n## Exam alignment\n\nCRISC (Monitoring; KRIs).', 22, 2),
  ('e0000000-0000-4000-8000-000000000039', 'd0000000-0000-4000-8000-000000000033', 'Risk Register and Lifecycle', 'Maintaining the risk register and review cycle.', E'# Risk Register and Lifecycle\n\n## Introduction\n\nThis lesson covers the risk register: what it contains, who owns it, and how to keep it current through a defined lifecycle. You will learn good practice for risk register maintenance and review.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Describe the typical contents of a risk register.\n- Define roles: owner, risk function, committee.\n- Run a risk review cycle (quarterly, annual) and keep the register current.\n\n## Risk Register Contents\n\nA **risk register** typically holds: risk ID, description, category, scenario, likelihood, impact, risk level, owner, response strategy, treatment plan, status, and last review date. It may link to controls and to KRIs. It should be a single source of truth for "what we know about our risk" and support reporting and audit.\n\n## Roles\n\nThe **risk owner** is accountable for the risk and its treatment (often a business or IT lead). The **risk function** (e.g. risk manager, CISO) facilitates identification, assessment, and reporting and ensures consistency. **Committees** (e.g. risk committee) review the register, approve acceptance, and prioritise treatment. Clear roles prevent the register from becoming outdated or ignored.\n\n## Lifecycle and Review\n\n**Ongoing**: Update when new risks are identified, when treatment is completed, or when incidents occur. **Periodic review**: e.g. quarterly risk committee to review top risks and treatment progress; annual full review to reassess likelihood/impact and refresh scenarios. Retire closed risks; archive with rationale. Use the register in project and change governance so new initiatives are assessed.\n\n## Key takeaway\n\nThe risk register is the central record of risk and treatment. Define contents and roles; maintain it through a regular review cycle so it stays current and useful.\n\n## Exam alignment\n\nCRISC (Risk register; lifecycle).', 24, 3);

-- ========== BH-SPEC-GRC: LESSONS (Module 4 — Governance and Reporting) ==========
INSERT INTO public.lessons (id, module_id, title, description, content_markdown, duration_minutes, order_index) VALUES
  ('e0000000-0000-4000-8000-00000000003a', 'd0000000-0000-4000-8000-000000000034', 'Risk Governance and Committees', 'Structures and accountability for risk.', E'# Risk Governance and Committees\n\n## Introduction\n\nThis lesson covers risk governance: the structures, committees, and accountabilities that ensure risk is owned and reviewed at the right level. You will learn how to design and operate risk committees.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Describe typical risk governance structures (board, committee, owner).\n- Define the role of risk and audit committees.\n- Ensure clear accountability and escalation.\n\n## Governance Structure\n\nThe **board** retains overall accountability for risk oversight; it sets appetite and receives top-level reporting. A **risk committee** (or equivalent) may meet regularly to review the risk register, treatment progress, and KRIs; it escalates to the board when needed. **Risk owners** are accountable for specific risks and their treatment. Larger organisations may have an enterprise risk function that coordinates and reports.\n\n## Risk vs Audit Committee\n\n**Risk committee** focuses on risk identification, assessment, and response; it looks forward. **Audit committee** oversees internal and external audit and control effectiveness; it looks at whether controls are in place and working. They may be separate or combined; they should coordinate so that audit findings feed into risk and risk priorities guide audit focus.\n\n## Accountability and Escalation\n\nDefine escalation rules: when does a risk go to the committee? When to the board? (e.g. breach of tolerance, new critical risk, major incident.) Document in policy and terms of reference so everyone knows who decides what.\n\n## Key takeaway\n\nRisk governance requires clear structures, committees, and accountabilities. Align risk and audit oversight and define escalation so decisions are made at the right level.\n\n## Exam alignment\n\nCRISC (Governance; risk committee).', 23, 1),
  ('e0000000-0000-4000-8000-00000000003b', 'd0000000-0000-4000-8000-000000000034', 'Assurance and Third-Party Risk', 'Internal assurance and third-party risk management.', E'# Assurance and Third-Party Risk\n\n## Introduction\n\nThis lesson covers assurance (internal audit, self-assessment) and third-party risk management. You will learn how assurance supports risk management and how to assess and manage risk from vendors and partners.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Describe how internal assurance supports risk and control.\n- Assess and monitor third-party and vendor risk.\n- Integrate assurance findings into the risk register.\n\n## Assurance\n\n**Assurance** provides independent verification that controls exist and operate. **Internal audit** is a key assurance provider; it tests controls and reports gaps. **Self-assessment** is performed by control owners; it is less independent but supports continuous awareness. Use assurance to validate risk assessments: if controls are weak, residual risk is higher. Feed findings into the risk register and treatment plans.\n\n## Third-Party Risk\n\n**Third-party risk** arises from vendors, partners, and supply chain. Assess before engagement: security questionnaire, certifications, contract terms. Monitor during: performance, incidents, and changes in the third party''s posture. Have exit and contingency plans. Map critical third parties to your risk register and treat them as extended risk.\n\n## Integrating Findings\n\nWhen assurance finds control gaps, update the risk register: add or revise risks, adjust likelihood or impact, assign treatment. Track findings to closure. Use trend (e.g. repeat findings) to prioritise and to improve control design.\n\n## Key takeaway\n\nAssurance and third-party risk management validate and extend risk coverage. Integrate findings into the risk register and treatment so risk view stays current.\n\n## Exam alignment\n\nCRISC (Assurance; third-party risk).', 25, 2),
  ('e0000000-0000-4000-8000-00000000003c', 'd0000000-0000-4000-8000-000000000034', 'Risk Culture and Communication', 'Building a risk-aware culture.', E'# Risk Culture and Communication\n\n## Introduction\n\nThis lesson covers risk culture and how to communicate risk so that the organisation thinks and acts in a risk-aware way. You will learn how to embed risk in decision-making and day-to-day behaviour.\n\n## Objectives\n\nBy the end of this lesson you will be able to:\n\n- Describe what risk culture is and why it matters.\n- Communicate risk effectively to different audiences.\n- Promote risk ownership and escalation.\n\n## Risk Culture\n\n**Risk culture** is the set of values, attitudes, and behaviours that determine how the organisation handles risk. A positive culture: people understand risk, own it where appropriate, and escalate when needed. A weak culture: risk is seen as "someone else''s job" or hidden. Culture is influenced by leadership tone, incentives, training, and how incidents and near-misses are treated (blame vs learning).\n\n## Communication\n\nCommunicate risk in a way that fits the audience: executives need summary and decisions; technical teams need specifics; the board needs strategy and trend. Use clear language; avoid jargon. Tell stories where they illustrate impact (e.g. "This control prevented X"). Reinforce that risk management enables the business, it does not just say no.\n\n## Ownership and Escalation\n\nEveryone should know who owns which risk and when to escalate. Train on risk policy, appetite, and how to report. Reward good behaviour (e.g. raising concerns early); avoid punishing messengers. Make the risk register and KRIs visible so risk is not abstract.\n\n## Key takeaway\n\nRisk culture and communication make risk management effective at scale. Build ownership and escalation; communicate clearly; reinforce that risk awareness supports the organisation.\n\n## Exam alignment\n\nCRISC (Risk culture; communication).', 22, 3);

COMMIT;
